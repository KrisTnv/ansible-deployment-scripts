---
 - hosts: serverhost
   connection: ssh
   become: yes
   become_method: sudo
   gather_facts: no

   tasks:

#   - name: Ensure kris is absent
#     community.general.ipa_user:
#       validate_certs: no
#       name: kris
#       state: absent
#       ipa_host: ipaserver.example.com
#       ipa_user: admin
#       ipa_pass: RuZ5AWiu1

   - name: Ensure kris is present and always reset password
     community.general.ipa_user:
       validate_certs: no
       name: kris
       state: present
       givenname: kris
       sn: tanev
       mail:
       - kris@tanev.com
       telephonenumber:
       - '+555123456'
       sshpubkey:
#       - ssh-rsa ....
#       - ssh-dsa ....
       uidnumber: '1001'
       gidnumber: '100'
       homedirectory: /home/kris
       ipa_host: ipaserver.example.com
       ipa_user: admin
       ipa_pass: RuZ5AWiu1
